{
  "permissions": {
    "allow": [
      "mcp__playwright__browser_snapshot",
      "Bash(redis-cli ping:*)",
      "Bash(where:*)",
      "Bash(\".venv/Scripts/python.exe\" -m uvicorn app.main:app --reload --port 8000)",
      "Bash(npm run dev:*)",
      "Bash(\".venv/Scripts/python.exe\" -m celery -A app.workers.celery worker --loglevel=info --pool=solo -E)",
      "mcp__playwright__browser_navigate",
      "mcp__playwright__browser_type",
      "mcp__playwright__browser_click",
      "mcp__playwright__browser_file_upload",
      "Bash(curl:*)",
      "mcp__playwright__browser_wait_for",
      "mcp__playwright__browser_console_messages",
      "mcp__playwright__browser_press_key",
      "mcp__playwright__browser_network_requests",
      "Skill(bmad:bmm:agents:dev)",
      "Skill(bmad:bmm:agents:dev:*)",
      "Bash(.venvScriptspython -c \"from app.services.supabase.client import _create_http_client; print\\(''Import successful''\\); c = _create_http_client\\(\\); print\\(f''HTTP client created: http2={c._transport._pool._http2}''\\)\")",
      "Bash(cd:*)",
      "Bash(.venv/Scripts/python:*)",
      "Bash(tasklist:*)",
      "mcp__playwright__browser_close",
      "Bash(\".venv/Scripts/celery\" -A app.workers.celery worker --loglevel=INFO --pool=solo)",
      "Bash(taskkill /F /FI \"WINDOWTITLE eq *celery*\")",
      "Bash(\".venv/Scripts/celery\" -A app.workers.celery worker --loglevel=INFO --pool=solo -E)",
      "Bash(.venvScriptspython -c \"\nfrom app.services.supabase.client import get_service_client\nclient = get_service_client\\(\\)\n\n# Check timeline events for the document\nresult = client.table\\(''timeline_events''\\).select\\(''id, event_date, event_type, headline''\\).eq\\(''document_id'', ''9860f2a1-1017-46b6-b1b7-0a72db2f25c0''\\).limit\\(5\\).execute\\(\\)\nprint\\(''Timeline events:'', len\\(result.data\\)\\)\nfor e in result.data[:3]:\n    print\\(f''  - {e}''\\)\n\")",
      "Bash(.venv/Scripts/python.exe:*)",
      "Bash(netstat:*)",
      "Bash(findstr:*)",
      "Bash(taskkill:*)",
      "Bash(uv run:*)",
      "Bash(timeout:*)",
      "Bash(ping:*)",
      "Bash(supabase status:*)",
      "mcp__playwright__browser_run_code",
      "Bash(npx supabase:*)",
      "mcp__playwright__browser_install",
      "Bash(python:*)",
      "Bash(powershell:*)",
      "Bash(docker ps:*)",
      "Bash(docker exec:*)",
      "Bash(.venvScriptspython -c \"\nimport os\nimport sys\nsys.path.insert\\(0, ''.''\\)\nfrom dotenv import load_dotenv\nload_dotenv\\(\\)\n\n# Trigger document processing manually via Celery\nfrom app.workers.celery_app import celery_app\nfrom app.workers.tasks.document_tasks import process_document_task\n\ndoc_id = ''ed3313dc-0ff4-4079-8aee-656b48dad9e7''\nmatter_id = ''fe8f5701-96e9-4975-a28b-59e5b0e380d5''\n\nprint\\(f''Triggering document processing for: {doc_id}''\\)\n\n# Send task to Celery\nresult = process_document_task.delay\\(document_id=doc_id, matter_id=matter_id\\)\nprint\\(f''Task ID: {result.id}''\\)\nprint\\(f''Task Status: {result.status}''\\)\n\")",
      "Bash(cmd /c \".venv\\\\Scripts\\\\python -c \"\"import os; import sys; sys.path.insert\\(0, ''.''\\); exec\\(open\\(''trigger_task.py''\\).read\\(\\) if os.path.exists\\(''trigger_task.py''\\) else print\\(''no file''\\)\\)\"\"\")",
      "Bash(\".venv\\\\Scripts\\\\python.exe\" trigger_task.py)",
      "Bash(\".venv\\\\Scripts\\\\python.exe\":*)",
      "Bash(\".venv\\\\Scripts\\\\python.exe\" monitor_pipeline.py)",
      "Bash(\".venv\\\\Scripts\\\\python.exe\" -c \"\nimport os\nimport sys\nsys.path.insert\\(0, ''.''\\)\nfrom dotenv import load_dotenv\nload_dotenv\\(\\)\n\nfrom supabase import create_client\nfrom openai import OpenAI\nimport json\nimport math\n\n# Initialize clients\nurl = os.getenv\\(''SUPABASE_URL''\\)\nkey = os.getenv\\(''SUPABASE_SERVICE_KEY''\\)\nsupabase = create_client\\(url, key\\)\nopenai_client = OpenAI\\(api_key=os.getenv\\(''OPENAI_API_KEY''\\)\\)\n\nmatter_id = ''fe8f5701-96e9-4975-a28b-59e5b0e380d5''\ndoc_id = ''ed3313dc-0ff4-4079-8aee-656b48dad9e7''\n\nprint\\(''=== Testing RAG Query Pipeline ===''\\)\nprint\\(\\)\n\n# Get chunks for this document\nchunks = supabase.table\\(''chunks''\\).select\\(''id, content, embedding, page_number''\\).eq\\(''document_id'', doc_id\\).execute\\(\\)\nprint\\(f''Document has {len\\(chunks.data\\)} chunks with embeddings''\\)\nprint\\(\\)\n\n# Test query\nquery = ''Who is the respondent in this affidavit case?''\nprint\\(f''Query: \"\"{query}\"\"''\\)\nprint\\(\\)\n\n# Generate query embedding\nresponse = openai_client.embeddings.create\\(\n    input=query,\n    model=''text-embedding-3-small'',\n    dimensions=1536\n\\)\nquery_embedding = response.data[0].embedding\n\n# Calculate similarities\ndef cosine_similarity\\(a, b\\):\n    dot = sum\\(x*y for x,y in zip\\(a,b\\)\\)\n    norm_a = math.sqrt\\(sum\\(x*x for x in a\\)\\)\n    norm_b = math.sqrt\\(sum\\(x*x for x in b\\)\\)\n    return dot / \\(norm_a * norm_b\\) if norm_a and norm_b else 0\n\nresults = []\nfor chunk in chunks.data:\n    emb = json.loads\\(chunk[''embedding'']\\) if isinstance\\(chunk[''embedding''], str\\) else chunk[''embedding'']\n    sim = cosine_similarity\\(query_embedding, emb\\)\n    results.append\\({\n        ''content'': chunk[''content''],\n        ''page'': chunk.get\\(''page_number''\\),\n        ''similarity'': sim\n    }\\)\n\nresults.sort\\(key=lambda x: x[''similarity''], reverse=True\\)\n\nprint\\(''=== Top 3 RAG Results ===''\\)\nfor i, r in enumerate\\(results[:3]\\):\n    content = r[''content''][:300] if r[''content''] else ''''\n    content = ''''.join\\(c if ord\\(c\\) < 128 else ''?'' for c in content\\).replace\\(chr\\(10\\), '' ''\\)\n    print\\(f''{i+1}. Similarity: {r[\"\"similarity\"\"]:.4f} | Page: {r[\"\"page\"\"]}''\\)\n    print\\(f''   {content}...''\\)\n    print\\(\\)\n\")",
      "Bash(\".venv\\\\Scripts\\\\python.exe\" -c:*)",
      "mcp__playwright__browser_take_screenshot",
      "Bash(\".venv\\\\Scripts\\\\python.exe\" -c \"\nimport os\nimport sys\nsys.path.insert\\(0, ''.''\\)\nfrom dotenv import load_dotenv\nload_dotenv\\(\\)\n\nfrom supabase import create_client\n\nurl = os.getenv\\(''SUPABASE_URL''\\)\nkey = os.getenv\\(''SUPABASE_SERVICE_KEY''\\)\n\nclient = create_client\\(url, key\\)\nmatter_id = ''fe8f5701-96e9-4975-a28b-59e5b0e380d5''\n\n# Check documents table columns\nprint\\(''=== Documents table columns ===''\\)\ndoc = client.table\\(''documents''\\).select\\(''*''\\).limit\\(1\\).execute\\(\\)\nif doc.data:\n    print\\(f''Columns: {list\\(doc.data[0].keys\\(\\)\\)}''\\)\n    print\\(f''Filename value: {doc.data[0].get\\(\"\"filename\"\"\\)}''\\)\n    print\\(f''Name value: {doc.data[0].get\\(\"\"name\"\"\\)}''\\)\n\n# Query chunks without the join\nprint\\(\\)\nprint\\(''=== Chunks without documents join ===''\\)\nresult = client.table\\(''chunks''\\).select\\(''id, content, page_number, document_id''\\).eq\\(''matter_id'', matter_id\\).order\\(''created_at'', desc=True\\).limit\\(3\\).execute\\(\\)\n\nprint\\(f''Chunks found: {len\\(result.data\\)}''\\)\nfor c in result.data:\n    print\\(f''  ID: {c[\"\"id\"\"][:8]}... | Page: {c.get\\(\"\"page_number\"\"\\)} | Doc: {c.get\\(\"\"document_id\"\"\\)[:8]}...''\\)\n\")",
      "Bash(dir:*)",
      "Bash(wmic process where \"ProcessId=54248\" get CommandLine)",
      "Bash(wmic process:*)",
      "Bash(del \"e:\\\\Career coaching\\\\100x\\\\LDIP\\\\backend\\\\.env.local\")",
      "Bash(rabbitmq-server:*)",
      "Bash(cmd /c \"where supabase 2>&1\")",
      "Bash(git add:*)"
    ]
  }
}
